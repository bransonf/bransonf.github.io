<!DOCTYPE html>
<html>
    <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Interactive Heat Map</title>
  <style type="text/css">
    html,body{margin:0px;height:100%;width:100%}
    .container{width:100%;height:100%}
    .my-control{background:#051127;border-radius:5px;color:#fff;height:50px;line-height:50px;text-align:center;font-size:30px;padding:0 8px}
  </style>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/maptalks/dist/maptalks.css">
  <script type="text/javascript" src="https://unpkg.com/maptalks/dist/maptalks.min.js"></script>
<script type="text/javascript" src="https://unpkg.com/maptalks.heatmap/dist/maptalks.heatmap.min.js"></script>
        <script src="../data/csb/traffic2008.json"></script>
        </head>
  <body>

    <div id="map" class="container">

      </div>

    <script>
        
        // Setup Map
      var map = new maptalks.Map('map', {
        center: [-90.2500,38.6270],
        zoom: 12,
        baseLayer: new maptalks.TileLayer('base', {
          urlTemplate: 'http://tile.stamen.com/terrain/{z}/{x}/{y}.jpg',
          subdomains: ['a','b','c','d'],
          attribution: 'Map tiles by <a href="http://stamen.com">Stamen Design</a>, under <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a>. Data by <a href="http://openstreetmap.org">OpenStreetMap</a>, under <a href="http://www.openstreetmap.org/copyright">ODbL</a>.'
            
            
        })
      });
        
        // Add Heatmap Layer
        
        var data = [];
        
        for (var i = 0; i < traf08.length; i++) { 
            data.push([traf08[i].x, traf08[i].y])
        }
        
    
        var heatLayer = new maptalks.HeatLayer('heat', data).addTo(map);
        
        heatLayer.config({
                'gradient' : {0.4: "purple", 0.6: "blue", 0.7: "green", 0.8: "lightgreen", 1: "yellow"}
            });

        // Add control
        
        const options = {
        'position' : 'top-right',
        'content'  : 'My Control'
      };

      class MyControl extends maptalks.control.Control {
        buildOn(map) {
          var dom = maptalks.DomUtil.createEl('div', 'my-control');
          dom.innerText = this.options['content'];
          return dom;
        }
      }

      MyControl.mergeOptions(options);

      var control = new MyControl({
        'content'   : 'Traffic Service Requests, 2008'
      });
      map.addControl(control);
        
    </script>
      
  </body>
</html>